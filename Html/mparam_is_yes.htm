<!doctype html public "-//w3c//dtd html 4.0 final//en">
<html>
   <head>
      <title>D:\Projects\UISUG\Uiautos\mparam_is_yes.sas</title>
   </head>
   <body>
      <pre>
/******************* URBAN INSTITUTE MACRO LIBRARY *********************
 
 Macro: mparam_is_yes

 Description: Returns 1 if the macro parameter value is "Yes" 
 (could be "y", "Y", "Yes", "YE", etc.)
 
 Use: Function
 
 Author: Peter Tatian
 
***********************************************************************/

%macro mparam_is_yes( 
  param   /** Macro parameter value to test (must resolve to a single value) **/
  );

  /*************************** USAGE NOTES *****************************
   
   SAMPLE CALL: 
     %mparam_is_yes( &amp;quiet )

  *********************************************************************/

  /*************************** UPDATE NOTES ****************************


  *********************************************************************/

  %***** ***** ***** MACRO SET UP ***** ***** *****;
   
    %local ;
    
    
  %***** ***** ***** ERROR CHECKS ***** ***** *****;

  

  %***** ***** ***** MACRO BODY ***** ***** *****;
  
  %if %quote(%upcase((&amp;param))) = %quote((Y)) or
      %quote(%upcase((&amp;param))) = %quote((YE)) or
      %quote(%upcase((&amp;param))) = %quote((YES)) %then %do;
    1
  %end;
  %else %do;
    0
  %end;
  
  %***** ***** ***** CLEAN UP ***** ***** *****;

  
  
%mend mparam_is_yes;


/************************ UNCOMMENT TO TEST ***************************

  %let p = Y;
  %let result = %mparam_is_yes( &amp;p );
  %put p=&amp;p result=&amp;result;
  
  %let p = Ye;
  %let result = %mparam_is_yes( &amp;p );
  %put p=&amp;p result=&amp;result;

  %let p = yEs;
  %let result = %mparam_is_yes( &amp;p );
  %put p=&amp;p result=&amp;result;
  
  %let p = No;
  %let result = %mparam_is_yes( &amp;p );
  %put p=&amp;p result=&amp;result;
  
  %let p = ;
  %let result = %mparam_is_yes( &amp;p );
  %put p=&amp;p result=&amp;result;

/**********************************************************************/

      </pre>
   </body>
</html>
